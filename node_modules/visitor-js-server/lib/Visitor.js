"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = Visitor;

var _visitorJsShared = require("visitor-js-shared");

var _visitorJsShared2 = _interopRequireDefault(_visitorJsShared);

var _cookies = require("./cookies");

var _targetAdapter = require("./targetAdapter");

var _targetAdapter2 = _interopRequireDefault(_targetAdapter);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var keysForAmcvValues = ["MCMID", "MCAAMB", "MCAAMLH"];

function Visitor() {
    var sdid = null;

    this.generateSupplementalID = function () {
        sdid = _visitorJsShared2.default.generateSupplementalID();
        return sdid;
    };

    this.generateVisitorPayload = function (amcvCookie) {
        var visitorPayload = { sdid: this.generateSupplementalID() };

        if (amcvCookie) {
            var amcvValues = (0, _cookies.parseValuesFromAmcvCookie)(amcvCookie, keysForAmcvValues);
            visitorPayload = Object.assign(visitorPayload, amcvValues);
        }

        var payloadAdaptedToTarget = _targetAdapter2.default.adapt(visitorPayload);
        return payloadAdaptedToTarget;
    };
}
module.exports = exports["default"];