const test = require("tape");
const amcvCookie = require("../lib/amcv-cookie");

const future = "2167743609";
const past = "526748409";

const cookie = "-179204249%7CMCIDTS%7C17043%7CMCMID%7C67165637736332133982173426459255729868" +
        "%7CMCAAMLH-" + past + "%7C9%7CMCAAMB-" + future + "%7CNRX38WO0n5BH8Th-nqAG_A%7CMCOPTOUT-1472486944s" +
        "%7CNONE%7CMCAID%7C2BD9A36D85078621-6000010D20286FCF";

const valuesToExtractFromAmcvCookie = [
    "MCMID",
    "MCAAMB",
    "MCAAMLH"
];

test("amcvCookie should implement expected API", (t) => {
    t.ok(amcvCookie.pickValues, "amcvCookie should expose `pickValues`");
    t.end();
});

test("calling pickValues with 3 valid values", (t) => {
    var values = amcvCookie.pickValues(cookie, valuesToExtractFromAmcvCookie);
    t.equal(values.MCMID, "67165637736332133982173426459255729868");
    t.equal(values.MCAAMLH, undefined);
    t.equal(values.MCAAMB, "NRX38WO0n5BH8Th-nqAG_A");
    t.end();
});
