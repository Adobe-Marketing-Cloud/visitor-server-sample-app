"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _utils=require("./utils");function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}// Target adapter will transform an object into the format of `targetSchema`.
function adapt(a){var b=renameKeys(a,payloadToTargetKeyMap),c=createTargetSchema();return populateCustomerIDs(c,b),populate(c,b)}exports.default={adapt:adapt};// Helpers and Consts:
var ID_KEY_BASE="vst",ID_KEY_SEPARATOR=".",payloadToTargetKeyMap={MCMID:"marketingCloudVisitorId",MCAAMB:"mboxAAMB",MCAAMLH:"mboxMCGLH",sdid:"mboxMCSDID"};function createTargetSchema(){return{marketingCloudVisitorId:void 0,mboxParameters:{mboxAAMB:void 0,mboxMCGLH:void 0,mboxMCSDID:void 0}}}function renameKeys(a,b){return Object.assign.apply(Object,[{}].concat(_toConsumableArray(Object.keys(a).map(function(c){var d=b[c]?b[c]:c;return _defineProperty({},d,a[c])}))))}function populateCustomerIDs(a,_ref2){var _ref2$customerIDs=_ref2.customerIDs,b=_ref2$customerIDs===void 0?{}:_ref2$customerIDs;(0,_utils.forEachKey)(b,function(c){var d=""+ID_KEY_BASE+ID_KEY_SEPARATOR+c,e=b[c];// If value is an object, populate this id in schema per this object's keys.
(0,_utils.isObject)(e)?(0,_utils.forEachKey)(e,function(f){var g=""+d+ID_KEY_SEPARATOR+f;a.mboxParameters[g]=e[f]}):a.mboxParameters[d]=e})}function populate(a,b){return Object.keys(a).forEach(function(c){(0,_utils.isObject)(a[c])?populate(a[c],b):b.hasOwnProperty(c)&&(a[c]=b[c])}),(0,_utils.filterBadProps)(a)}module.exports=exports["default"];